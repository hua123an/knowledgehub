{"version":3,"file":"main.js","sources":["../electron/database/index.ts","../node_modules/uuid/dist-node/stringify.js","../node_modules/uuid/dist-node/rng.js","../node_modules/uuid/dist-node/native.js","../node_modules/uuid/dist-node/v4.js","../electron/constants.ts","../electron/context.ts","../electron/ipc/notes.ts","../electron/ipc/folders.ts","../electron/ipc/tags.ts","../electron/ipc/links.ts","../electron/ipc/settings.ts","../electron/ai/service.ts","../electron/ai/index.ts","../electron/ipc/dialog.ts","../electron/ipc/index.ts","../electron/main.ts"],"sourcesContent":["import { app } from 'electron'\nimport * as path from 'path'\nimport * as fs from 'fs'\nimport { createRequire } from 'module'\n\n// ä½¿ç”¨ createRequire åŠ è½½åŸç”Ÿæ¨¡å—\nconst require = createRequire(import.meta.url)\nconst Database = require('better-sqlite3')\n\ntype DatabaseType = ReturnType<typeof Database>\nlet db: DatabaseType | null = null\n\nexport function getDatabase(): DatabaseType {\n  if (!db) {\n    throw new Error('Database not initialized')\n  }\n  return db\n}\n\nexport function initDatabase(): DatabaseType {\n  const userDataPath = app.getPath('userData')\n  const dbPath = path.join(userDataPath, 'knowledge.db')\n  \n  // ç¡®ä¿ç›®å½•å­˜åœ¨\n  if (!fs.existsSync(userDataPath)) {\n    fs.mkdirSync(userDataPath, { recursive: true })\n  }\n  \n  db = new Database(dbPath)\n  \n  // å¯ç”¨å¤–é”®çº¦æŸ\n  db.pragma('foreign_keys = ON')\n  \n  // åˆ›å»ºè¡¨ç»“æ„\n  const schema = `\n    -- ç¬”è®°/æ–‡æ¡£è¡¨\n    CREATE TABLE IF NOT EXISTS notes (\n      id TEXT PRIMARY KEY,\n      title TEXT NOT NULL,\n      content TEXT DEFAULT '',\n      type TEXT CHECK(type IN ('markdown', 'bookmark', 'snippet')) NOT NULL DEFAULT 'markdown',\n      folder_id TEXT,\n      url TEXT,\n      favicon TEXT,\n      description TEXT,\n      language TEXT,\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (folder_id) REFERENCES folders(id) ON DELETE SET NULL\n    );\n\n    -- æ ‡ç­¾è¡¨\n    CREATE TABLE IF NOT EXISTS tags (\n      id TEXT PRIMARY KEY,\n      name TEXT UNIQUE NOT NULL,\n      color TEXT DEFAULT '#409EFF'\n    );\n\n    -- ç¬”è®°-æ ‡ç­¾å…³è”è¡¨\n    CREATE TABLE IF NOT EXISTS note_tags (\n      note_id TEXT NOT NULL,\n      tag_id TEXT NOT NULL,\n      PRIMARY KEY (note_id, tag_id),\n      FOREIGN KEY (note_id) REFERENCES notes(id) ON DELETE CASCADE,\n      FOREIGN KEY (tag_id) REFERENCES tags(id) ON DELETE CASCADE\n    );\n\n    -- åŒå‘é“¾æ¥è¡¨\n    CREATE TABLE IF NOT EXISTS links (\n      source_id TEXT NOT NULL,\n      target_id TEXT NOT NULL,\n      PRIMARY KEY (source_id, target_id),\n      FOREIGN KEY (source_id) REFERENCES notes(id) ON DELETE CASCADE,\n      FOREIGN KEY (target_id) REFERENCES notes(id) ON DELETE CASCADE\n    );\n\n    -- æ–‡ä»¶å¤¹è¡¨\n    CREATE TABLE IF NOT EXISTS folders (\n      id TEXT PRIMARY KEY,\n      name TEXT NOT NULL,\n      parent_id TEXT,\n      sort_order INTEGER DEFAULT 0,\n      FOREIGN KEY (parent_id) REFERENCES folders(id) ON DELETE CASCADE\n    );\n\n    -- è®¾ç½®è¡¨\n    CREATE TABLE IF NOT EXISTS settings (\n      key TEXT PRIMARY KEY,\n      value TEXT\n    );\n  `\n  \n  db.exec(schema)\n  \n  // åˆ›å»ºå…¨æ–‡æœç´¢è¡¨ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰\n  try {\n    db.exec(`\n      CREATE VIRTUAL TABLE IF NOT EXISTS notes_fts USING fts5(\n        title,\n        content,\n        content='notes',\n        content_rowid='rowid'\n      );\n    `)\n  } catch (e) {\n    // FTSè¡¨å¯èƒ½å·²å­˜åœ¨\n  }\n  \n  // åˆ›å»ºè§¦å‘å™¨\n  try {\n    db.exec(`\n      CREATE TRIGGER IF NOT EXISTS notes_ai AFTER INSERT ON notes BEGIN\n        INSERT INTO notes_fts(rowid, title, content) VALUES (NEW.rowid, NEW.title, NEW.content);\n      END;\n    `)\n    db.exec(`\n      CREATE TRIGGER IF NOT EXISTS notes_au AFTER UPDATE ON notes BEGIN\n        INSERT INTO notes_fts(notes_fts, rowid, title, content) VALUES('delete', OLD.rowid, OLD.title, OLD.content);\n        INSERT INTO notes_fts(rowid, title, content) VALUES (NEW.rowid, NEW.title, NEW.content);\n      END;\n    `)\n    db.exec(`\n      CREATE TRIGGER IF NOT EXISTS notes_ad AFTER DELETE ON notes BEGIN\n        INSERT INTO notes_fts(notes_fts, rowid, title, content) VALUES('delete', OLD.rowid, OLD.title, OLD.content);\n      END;\n    `)\n  } catch (e) {\n    // è§¦å‘å™¨å¯èƒ½å·²å­˜åœ¨\n  }\n  \n  // åˆ›å»ºç´¢å¼•\n  try {\n    db.exec(`\n      CREATE INDEX IF NOT EXISTS idx_notes_folder ON notes(folder_id);\n      CREATE INDEX IF NOT EXISTS idx_notes_type ON notes(type);\n      CREATE INDEX IF NOT EXISTS idx_notes_updated ON notes(updated_at DESC);\n      CREATE INDEX IF NOT EXISTS idx_folders_parent ON folders(parent_id);\n      CREATE INDEX IF NOT EXISTS idx_note_tags_note ON note_tags(note_id);\n      CREATE INDEX IF NOT EXISTS idx_note_tags_tag ON note_tags(tag_id);\n      CREATE INDEX IF NOT EXISTS idx_links_source ON links(source_id);\n      CREATE INDEX IF NOT EXISTS idx_links_target ON links(target_id);\n    `)\n  } catch (e) {\n    // ç´¢å¼•å¯èƒ½å·²å­˜åœ¨\n  }\n  \n  return db\n}\n\nexport function closeDatabase() {\n  if (db) {\n    db.close()\n    db = null\n  }\n}\n","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","import { randomFillSync } from 'node:crypto';\nconst rnds8Pool = new Uint8Array(256);\nlet poolPtr = rnds8Pool.length;\nexport default function rng() {\n    if (poolPtr > rnds8Pool.length - 16) {\n        randomFillSync(rnds8Pool);\n        poolPtr = 0;\n    }\n    return rnds8Pool.slice(poolPtr, (poolPtr += 16));\n}\n","import { randomUUID } from 'node:crypto';\nexport default { randomUUID };\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction _v4(options, buf, offset) {\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    return _v4(options, buf, offset);\n}\nexport default v4;\n","// IPC é€šé“åç§°\nexport const IPC_CHANNELS = {\n  // æ•°æ®åº“æ“ä½œ\n  DB_INIT: 'db:init',\n  DB_QUERY: 'db:query',\n  DB_RUN: 'db:run',\n  \n  // ç¬”è®°æ“ä½œ\n  NOTE_CREATE: 'note:create',\n  NOTE_UPDATE: 'note:update',\n  NOTE_DELETE: 'note:delete',\n  NOTE_GET: 'note:get',\n  NOTE_LIST: 'note:list',\n  NOTE_SEARCH: 'note:search',\n  \n  // æ–‡ä»¶å¤¹æ“ä½œ\n  FOLDER_CREATE: 'folder:create',\n  FOLDER_UPDATE: 'folder:update',\n  FOLDER_DELETE: 'folder:delete',\n  FOLDER_LIST: 'folder:list',\n  \n  // æ ‡ç­¾æ“ä½œ\n  TAG_CREATE: 'tag:create',\n  TAG_UPDATE: 'tag:update',\n  TAG_DELETE: 'tag:delete',\n  TAG_LIST: 'tag:list',\n  TAG_ADD_TO_NOTE: 'tag:addToNote',\n  TAG_REMOVE_FROM_NOTE: 'tag:removeFromNote',\n  \n  // é“¾æ¥æ“ä½œ\n  LINK_CREATE: 'link:create',\n  LINK_DELETE: 'link:delete',\n  LINK_GET_BY_NOTE: 'link:getByNote',\n  LINK_GET_GRAPH: 'link:getGraph',\n  \n  // æ–‡ä»¶æ“ä½œ\n  FILE_READ: 'file:read',\n  FILE_WRITE: 'file:write',\n  FILE_DELETE: 'file:delete',\n  \n  // è®¾ç½®\n  SETTINGS_GET: 'settings:get',\n  SETTINGS_SET: 'settings:set',\n\n  // AI\n  AI_CHAT: 'ai:chat',\n  AI_CHAT_STREAM: 'ai:chatStream',\n  AI_STOP: 'ai:stop',\n  AI_SUMMARIZE: 'ai:summarize',\n  AI_SUGGEST_TAGS: 'ai:suggestTags',\n  AI_POLISH: 'ai:polish',\n  AI_CONTINUE: 'ai:continue',\n  AI_TRANSLATE: 'ai:translate',\n  AI_EXPLAIN: 'ai:explain',\n  AI_SEARCH_ENHANCE: 'ai:searchEnhance',\n  AI_CHAT_HISTORY_LIST: 'ai:chatHistoryList',\n  AI_CHAT_HISTORY_GET: 'ai:chatHistoryGet',\n  AI_CHAT_HISTORY_SAVE: 'ai:chatHistorySave',\n  AI_CHAT_HISTORY_DELETE: 'ai:chatHistoryDelete',\n  // ç³»ç»Ÿ\n  SYSTEM_REVEAL: 'system:reveal',\n} as const\n\n","// å…¨å±€ä¸Šä¸‹æ–‡ï¼Œç”¨äºåœ¨ä¸åŒ IPC æ¨¡å—é—´å…±äº«çŠ¶æ€\nexport const globalContext = {\n  currentWorkspace: null as string | null\n}\n","import { ipcMain } from 'electron'\nimport * as fs from 'fs'\nimport * as path from 'path'\nimport { v4 as uuidv4 } from 'uuid'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\nimport { globalContext } from '../context'\n\ninterface NoteRow {\n  id: string\n  title: string\n  content: string\n  type: string\n  folder_id: string | null\n  url: string | null\n  favicon: string | null\n  description: string | null\n  language: string | null\n  created_at: string\n  updated_at: string\n}\n\nfunction rowToNote(row: NoteRow) {\n  return {\n    id: row.id,\n    title: row.title,\n    content: row.content,\n    type: row.type as 'markdown' | 'bookmark' | 'snippet',\n    folderId: row.folder_id,\n    url: row.url || undefined,\n    favicon: row.favicon || undefined,\n    description: row.description || undefined,\n    language: row.language || undefined,\n    createdAt: row.created_at,\n    updatedAt: row.updated_at,\n  }\n}\n\nexport function registerNoteHandlers() {\n  const db = getDatabase()\n\n  // åˆ›å»ºç¬”è®°\n  ipcMain.handle(IPC_CHANNELS.NOTE_CREATE, async (_event, note) => {\n    try {\n      const id = uuidv4()\n      const now = new Date().toISOString()\n      \n      const stmt = db.prepare(`\n        INSERT INTO notes (id, title, content, type, folder_id, url, favicon, description, language, created_at, updated_at)\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      `)\n      \n      stmt.run(\n        id,\n        note.title || 'æ— æ ‡é¢˜',\n        note.content || '',\n        note.type || 'markdown',\n        note.folderId || null,\n        note.url || null,\n        note.favicon || null,\n        note.description || null,\n        note.language || null,\n        now,\n        now\n      )\n      \n      const created = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow\n      \n      // åŒæ­¥å†™å…¥æ–‡ä»¶ç³»ç»Ÿ\n      if (globalContext.currentWorkspace) {\n         const filename = `${created.title}.md`\n         const filePath = path.join(globalContext.currentWorkspace, filename)\n         try {\n           // ç¡®ä¿ä¸è¦†ç›–ç°æœ‰æ–‡ä»¶ï¼ˆè™½ç„¶ uuid ä¿è¯ id å”¯ä¸€ï¼Œä½† title å¯èƒ½é‡å¤ï¼‰\n           // å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåº”è¯¥æŠ¥é”™è¿˜æ˜¯è‡ªåŠ¨é‡å‘½åï¼Ÿ\n           // ç›®å‰ç®€å•å¤„ç†ï¼šå¦‚æœå­˜åœ¨ï¼Œè¦†ç›–ï¼ˆå› ä¸ºè¿™æ˜¯æ–°å»ºæ“ä½œï¼Œä¸”å‰ç«¯å¯èƒ½æ²¡æœ‰é‡å¤æ£€æŸ¥ï¼‰\n           // æ›´å¥½çš„åšæ³•æ˜¯åœ¨å‰ç«¯æ£€æŸ¥ title å”¯ä¸€æ€§ã€‚\n           // è¿™é‡Œæˆ‘ä»¬ç›´æ¥å†™å…¥ã€‚\n           fs.writeFileSync(filePath, created.content || '', 'utf-8')\n           console.log('[Main] Created file:', filePath)\n         } catch (e) {\n           console.error('[Main] Create file failed:', e)\n         }\n      }\n\n      return { success: true, data: rowToNote(created) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // æ›´æ–°ç¬”è®°\n  ipcMain.handle(IPC_CHANNELS.NOTE_UPDATE, async (_event, id, updates) => {\n    try {\n      // Get existing note first for rename logic\n      const existing = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow | undefined\n      if (!existing) {\n        return { success: false, error: 'Note not found' }\n      }\n\n      const fields: string[] = []\n      const values: any[] = []\n      \n      if (updates.title !== undefined) {\n        fields.push('title = ?')\n        values.push(updates.title)\n      }\n      if (updates.content !== undefined) {\n        fields.push('content = ?')\n        values.push(updates.content)\n      }\n      if (updates.folderId !== undefined) {\n        fields.push('folder_id = ?')\n        values.push(updates.folderId)\n      }\n      if (updates.url !== undefined) {\n        fields.push('url = ?')\n        values.push(updates.url)\n      }\n      if (updates.favicon !== undefined) {\n        fields.push('favicon = ?')\n        values.push(updates.favicon)\n      }\n      if (updates.description !== undefined) {\n        fields.push('description = ?')\n        values.push(updates.description)\n      }\n      if (updates.language !== undefined) {\n        fields.push('language = ?')\n        values.push(updates.language)\n      }\n      \n      fields.push('updated_at = ?')\n      values.push(new Date().toISOString())\n      values.push(id)\n      \n      const stmt = db.prepare(`UPDATE notes SET ${fields.join(', ')} WHERE id = ?`)\n      stmt.run(...values)\n      \n      const updated = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow\n\n      // åŒæ­¥å†™å…¥æ–‡ä»¶ç³»ç»Ÿ\n      if (globalContext.currentWorkspace && updated) {\n        // ç®€å•ç­–ç•¥ï¼šæŒ‰ title å¯»æ‰¾æ–‡ä»¶å\n        const filename = `${updated.title}.md`\n        const filePath = path.join(globalContext.currentWorkspace, filename)\n        \n        // 1. å¦‚æœ title å˜äº†ï¼Œå…ˆé‡å‘½åæ—§æ–‡ä»¶\n        if (updates.title !== undefined && updates.title !== existing.title) {\n           const oldPath = path.join(globalContext.currentWorkspace, `${existing.title}.md`)\n           try {\n             if (fs.existsSync(oldPath)) {\n               fs.renameSync(oldPath, filePath)\n               console.log('[Main] Renamed file:', oldPath, '->', filePath)\n             }\n           } catch (e) {\n             console.error('[Main] Rename failed:', e)\n           }\n        }\n\n        // 2. å†™å…¥/æ›´æ–°å†…å®¹ (å¦‚æœæ˜¯é‡å‘½ååçš„æ–‡ä»¶ï¼Œè¿™é‡Œä¹Ÿä¼šæ›´æ–°å†…å®¹)\n        // åªæœ‰å½“æ›´æ–°äº† content æˆ–è€… title (å¯¼è‡´æ–‡ä»¶åå˜åŒ–) æ—¶ï¼Œæˆ‘ä»¬æ‰ç¡®ä¿æ–‡ä»¶å­˜åœ¨\n        // ä½†è¿™é‡Œæˆ‘ä»¬ç®€å•ç‚¹ï¼šåªè¦æœ‰ currentWorkspaceï¼Œæ¯æ¬¡ update éƒ½ç¡®ä¿æ–‡ä»¶å†…å®¹æ˜¯æœ€æ–°çš„\n        // æˆ–è€…æ˜¯åªåœ¨ content å˜åŠ¨æ—¶å†™ï¼Ÿ\n        // å¦‚æœåªé‡å‘½åï¼Œcontent æ²¡ä¼ ï¼Œæˆ‘ä»¬éœ€è¦è¯» DB é‡Œçš„ content å†™è¿›å»å—ï¼Ÿ\n        // renameSync å·²ç»ç§»åŠ¨äº†æ–‡ä»¶å†…å®¹ã€‚æ‰€ä»¥åªè¦ content æ²¡å˜ï¼Œä¸éœ€è¦é‡å†™ã€‚\n        \n        if (updates.content !== undefined) {\n           try {\n             fs.writeFileSync(filePath, updates.content, 'utf-8')\n             console.log('[Main] Saved file:', filePath)\n           } catch (e) {\n             console.error('[Main] Save failed:', e)\n           }\n        }\n      }\n\n      return { success: true, data: rowToNote(updated) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // åˆ é™¤ç¬”è®°\n  ipcMain.handle(IPC_CHANNELS.NOTE_DELETE, async (_event, id) => {\n    try {\n      // Get existing note to find file path\n      const existing = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow | undefined\n      if (globalContext.currentWorkspace && existing) {\n         const filePath = path.join(globalContext.currentWorkspace, `${existing.title}.md`)\n         try {\n           if (fs.existsSync(filePath)) {\n             fs.unlinkSync(filePath)\n             console.log('[Main] Deleted file:', filePath)\n           }\n         } catch (e) {\n           console.error('[Main] Delete file failed:', e)\n         }\n      }\n\n      db.prepare('DELETE FROM notes WHERE id = ?').run(id)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // è·å–å•ä¸ªç¬”è®°\n  ipcMain.handle(IPC_CHANNELS.NOTE_GET, async (_event, id) => {\n    try {\n      const row = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow | undefined\n      if (row) {\n        return { success: true, data: rowToNote(row) }\n      }\n      return { success: false, error: 'Note not found' }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // è·å–ç¬”è®°åˆ—è¡¨\n  ipcMain.handle(IPC_CHANNELS.NOTE_LIST, async (_event, filters = {}) => {\n    try {\n      let sql = 'SELECT * FROM notes WHERE 1=1'\n      const params: any[] = []\n      \n      if (filters.type) {\n        sql += ' AND type = ?'\n        params.push(filters.type)\n      }\n      if (filters.folderId !== undefined) {\n        if (filters.folderId === null) {\n          sql += ' AND folder_id IS NULL'\n        } else {\n          sql += ' AND folder_id = ?'\n          params.push(filters.folderId)\n        }\n      }\n      \n      sql += ' ORDER BY updated_at DESC'\n      \n      const rows = db.prepare(sql).all(...params) as NoteRow[]\n      return { success: true, data: rows.map(rowToNote) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // æœç´¢ç¬”è®°\n  ipcMain.handle(IPC_CHANNELS.NOTE_SEARCH, async (_event, query) => {\n    try {\n      if (!query || query.trim() === '') {\n        return { success: true, data: [] }\n      }\n      \n      const searchTerm = `%${query}%`\n      const rows = db.prepare(`\n        SELECT * FROM notes \n        WHERE title LIKE ? OR content LIKE ?\n        ORDER BY updated_at DESC\n        LIMIT 50\n      `).all(searchTerm, searchTerm) as NoteRow[]\n      \n      const results = rows.map(row => {\n        // æ‰‹åŠ¨ç”Ÿæˆç®€å•çš„æ‘˜è¦å’Œé«˜äº®\n        let snippet = (row.content || '').slice(0, 150)\n        if (row.content && row.content.toLowerCase().includes(query.toLowerCase())) {\n          const idx = row.content.toLowerCase().indexOf(query.toLowerCase())\n          const start = Math.max(0, idx - 40)\n          const end = Math.min(row.content.length, idx + 80)\n          snippet = (start > 0 ? '...' : '') + row.content.slice(start, end) + (end < row.content.length ? '...' : '')\n        }\n\n        const matchField = row.title.toLowerCase().includes(query.toLowerCase()) ? 'æ ‡é¢˜' : 'å†…å®¹'\n\n        return {\n          note: rowToNote(row),\n          matchField,\n          contentSnippet: snippet,\n          score: 0,\n        }\n      })\n      \n      return { success: true, data: results }\n    } catch (error) {\n      console.error('Search error:', error)\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { v4 as uuidv4 } from 'uuid'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\ninterface FolderRow {\n  id: string\n  name: string\n  parent_id: string | null\n  sort_order: number\n}\n\nfunction rowToFolder(row: FolderRow) {\n  return {\n    id: row.id,\n    name: row.name,\n    parentId: row.parent_id,\n    sortOrder: row.sort_order,\n  }\n}\n\nexport function registerFolderHandlers() {\n  const db = getDatabase()\n\n  // åˆ›å»ºæ–‡ä»¶å¤¹\n  ipcMain.handle(IPC_CHANNELS.FOLDER_CREATE, async (_event, folder) => {\n    try {\n      const id = uuidv4()\n      \n      // è·å–åŒçº§æ–‡ä»¶å¤¹ä¸­çš„æœ€å¤§æ’åºå€¼\n        const maxOrder = folder.parentId\n          ? db.prepare('SELECT COALESCE(MAX(sort_order), -1) as max_order FROM folders WHERE parent_id = ?').get(folder.parentId) as { max_order: number }\n          : db.prepare('SELECT COALESCE(MAX(sort_order), -1) as max_order FROM folders WHERE parent_id IS NULL').get() as { max_order: number }\n      \n      const sortOrder = (maxOrder?.max_order ?? -1) + 1\n      \n      const stmt = db.prepare(`\n        INSERT INTO folders (id, name, parent_id, sort_order)\n        VALUES (?, ?, ?, ?)\n      `)\n      \n      stmt.run(id, folder.name || 'æ–°æ–‡ä»¶å¤¹', folder.parentId || null, sortOrder)\n      \n      const created = db.prepare('SELECT * FROM folders WHERE id = ?').get(id) as FolderRow\n      return { success: true, data: rowToFolder(created) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // æ›´æ–°æ–‡ä»¶å¤¹\n  ipcMain.handle(IPC_CHANNELS.FOLDER_UPDATE, async (_event, id, updates) => {\n    try {\n      const fields: string[] = []\n      const values: any[] = []\n      \n      if (updates.name !== undefined) {\n        fields.push('name = ?')\n        values.push(updates.name)\n      }\n      if (updates.parentId !== undefined) {\n        fields.push('parent_id = ?')\n        values.push(updates.parentId)\n      }\n      if (updates.sortOrder !== undefined) {\n        fields.push('sort_order = ?')\n        values.push(updates.sortOrder)\n      }\n      \n      if (fields.length === 0) {\n        const existing = db.prepare('SELECT * FROM folders WHERE id = ?').get(id) as FolderRow\n        return { success: true, data: rowToFolder(existing) }\n      }\n      \n      values.push(id)\n      \n      const stmt = db.prepare(`UPDATE folders SET ${fields.join(', ')} WHERE id = ?`)\n      stmt.run(...values)\n      \n      const updated = db.prepare('SELECT * FROM folders WHERE id = ?').get(id) as FolderRow\n      return { success: true, data: rowToFolder(updated) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // åˆ é™¤æ–‡ä»¶å¤¹\n  ipcMain.handle(IPC_CHANNELS.FOLDER_DELETE, async (_event, id) => {\n    try {\n      db.prepare('DELETE FROM folders WHERE id = ?').run(id)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // è·å–æ–‡ä»¶å¤¹åˆ—è¡¨\n  ipcMain.handle(IPC_CHANNELS.FOLDER_LIST, async () => {\n    try {\n      const rows = db.prepare('SELECT * FROM folders ORDER BY sort_order').all() as FolderRow[]\n      return { success: true, data: rows.map(rowToFolder) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { v4 as uuidv4 } from 'uuid'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\ninterface TagRow {\n  id: string\n  name: string\n  color: string\n}\n\nfunction rowToTag(row: TagRow) {\n  return {\n    id: row.id,\n    name: row.name,\n    color: row.color,\n  }\n}\n\n// é¢„å®šä¹‰çš„æ ‡ç­¾é¢œè‰²\nconst TAG_COLORS = [\n  '#409EFF', // è“è‰²\n  '#67C23A', // ç»¿è‰²\n  '#E6A23C', // æ©™è‰²\n  '#F56C6C', // çº¢è‰²\n  '#909399', // ç°è‰²\n  '#9B59B6', // ç´«è‰²\n  '#1ABC9C', // é’è‰²\n  '#E91E63', // ç²‰è‰²\n]\n\nexport function registerTagHandlers() {\n  const db = getDatabase()\n\n  // åˆ›å»ºæ ‡ç­¾\n  ipcMain.handle(IPC_CHANNELS.TAG_CREATE, async (_event, tag) => {\n    try {\n      const id = uuidv4()\n      \n      // éšæœºé€‰æ‹©ä¸€ä¸ªé¢œè‰²\n      const color = tag.color || TAG_COLORS[Math.floor(Math.random() * TAG_COLORS.length)]\n      \n      const stmt = db.prepare(`\n        INSERT INTO tags (id, name, color)\n        VALUES (?, ?, ?)\n      `)\n      \n      stmt.run(id, tag.name, color)\n      \n      const created = db.prepare('SELECT * FROM tags WHERE id = ?').get(id) as TagRow\n      return { success: true, data: rowToTag(created) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // æ›´æ–°æ ‡ç­¾\n  ipcMain.handle(IPC_CHANNELS.TAG_UPDATE, async (_event, id, updates) => {\n    try {\n      const fields: string[] = []\n      const values: any[] = []\n      \n      if (updates.name !== undefined) {\n        fields.push('name = ?')\n        values.push(updates.name)\n      }\n      if (updates.color !== undefined) {\n        fields.push('color = ?')\n        values.push(updates.color)\n      }\n      \n      if (fields.length === 0) {\n        const existing = db.prepare('SELECT * FROM tags WHERE id = ?').get(id) as TagRow\n        return { success: true, data: rowToTag(existing) }\n      }\n      \n      values.push(id)\n      \n      const stmt = db.prepare(`UPDATE tags SET ${fields.join(', ')} WHERE id = ?`)\n      stmt.run(...values)\n      \n      const updated = db.prepare('SELECT * FROM tags WHERE id = ?').get(id) as TagRow\n      return { success: true, data: rowToTag(updated) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // åˆ é™¤æ ‡ç­¾\n  ipcMain.handle(IPC_CHANNELS.TAG_DELETE, async (_event, id) => {\n    try {\n      db.prepare('DELETE FROM tags WHERE id = ?').run(id)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // è·å–æ ‡ç­¾åˆ—è¡¨\n  ipcMain.handle(IPC_CHANNELS.TAG_LIST, async () => {\n    try {\n      const rows = db.prepare('SELECT * FROM tags ORDER BY name').all() as TagRow[]\n      return { success: true, data: rows.map(rowToTag) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ç»™ç¬”è®°æ·»åŠ æ ‡ç­¾\n  ipcMain.handle(IPC_CHANNELS.TAG_ADD_TO_NOTE, async (_event, noteId, tagId) => {\n    try {\n      const stmt = db.prepare(`\n        INSERT OR IGNORE INTO note_tags (note_id, tag_id)\n        VALUES (?, ?)\n      `)\n      stmt.run(noteId, tagId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ä»ç¬”è®°ç§»é™¤æ ‡ç­¾\n  ipcMain.handle(IPC_CHANNELS.TAG_REMOVE_FROM_NOTE, async (_event, noteId, tagId) => {\n    try {\n      db.prepare('DELETE FROM note_tags WHERE note_id = ? AND tag_id = ?').run(noteId, tagId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\ninterface LinkRow {\n  source_id: string\n  target_id: string\n}\n\ninterface NoteBasic {\n  id: string\n  title: string\n  type: string\n}\n\nexport function registerLinkHandlers() {\n  const db = getDatabase()\n\n  // åˆ›å»ºé“¾æ¥\n  ipcMain.handle(IPC_CHANNELS.LINK_CREATE, async (_event, sourceId, targetId) => {\n    try {\n      const stmt = db.prepare(`\n        INSERT OR IGNORE INTO links (source_id, target_id)\n        VALUES (?, ?)\n      `)\n      stmt.run(sourceId, targetId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // åˆ é™¤é“¾æ¥\n  ipcMain.handle(IPC_CHANNELS.LINK_DELETE, async (_event, sourceId, targetId) => {\n    try {\n      db.prepare('DELETE FROM links WHERE source_id = ? AND target_id = ?').run(sourceId, targetId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // è·å–ç¬”è®°çš„æ‰€æœ‰é“¾æ¥\n  ipcMain.handle(IPC_CHANNELS.LINK_GET_BY_NOTE, async (_event, noteId) => {\n    try {\n      // è·å–å‡ºé“¾ï¼ˆå½“å‰ç¬”è®°é“¾æ¥åˆ°çš„ç¬”è®°ï¼‰\n      const outLinks = db.prepare(`\n        SELECT n.id, n.title, n.type\n        FROM links l\n        JOIN notes n ON n.id = l.target_id\n        WHERE l.source_id = ?\n      `).all(noteId) as NoteBasic[]\n\n      // è·å–å…¥é“¾ï¼ˆé“¾æ¥åˆ°å½“å‰ç¬”è®°çš„ç¬”è®°ï¼‰\n      const inLinks = db.prepare(`\n        SELECT n.id, n.title, n.type\n        FROM links l\n        JOIN notes n ON n.id = l.source_id\n        WHERE l.target_id = ?\n      `).all(noteId) as NoteBasic[]\n\n      return {\n        success: true,\n        data: {\n          outLinks: outLinks.map(n => ({ id: n.id, title: n.title, type: n.type })),\n          inLinks: inLinks.map(n => ({ id: n.id, title: n.title, type: n.type })),\n        },\n      }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // è·å–çŸ¥è¯†å›¾è°±æ•°æ®\n  ipcMain.handle(IPC_CHANNELS.LINK_GET_GRAPH, async () => {\n    try {\n      // è·å–æ‰€æœ‰ç¬”è®°ä½œä¸ºèŠ‚ç‚¹\n      const notes = db.prepare(`\n        SELECT id, title, type FROM notes\n      `).all() as NoteBasic[]\n\n      // è·å–æ‰€æœ‰é“¾æ¥ä½œä¸ºè¾¹\n      const links = db.prepare(`\n        SELECT source_id, target_id FROM links\n      `).all() as LinkRow[]\n\n      const nodes = notes.map(n => ({\n        id: n.id,\n        label: n.title,\n        type: n.type as 'markdown' | 'bookmark' | 'snippet',\n      }))\n\n        const edges = links.map(l => ({\n          source: l.source_id,\n          target: l.target_id,\n        }))\n\n        return { success: true, data: edges }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\nexport function registerSettingsHandlers() {\n  const db = getDatabase()\n\n  // è·å–è®¾ç½®\n  ipcMain.handle(IPC_CHANNELS.SETTINGS_GET, async () => {\n    try {\n      const rows = db.prepare('SELECT key, value FROM settings').all() as { key: string; value: string }[]\n      \n      const settings: Record<string, any> = {}\n      rows.forEach(row => {\n        try {\n          settings[row.key] = JSON.parse(row.value)\n        } catch {\n          settings[row.key] = row.value\n        }\n      })\n      \n      return { success: true, data: settings }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ä¿å­˜è®¾ç½®\n  ipcMain.handle(IPC_CHANNELS.SETTINGS_SET, async (_event, settings) => {\n    try {\n      const stmt = db.prepare(`\n        INSERT OR REPLACE INTO settings (key, value)\n        VALUES (?, ?)\n      `)\n      \n      Object.entries(settings).forEach(([key, value]) => {\n        stmt.run(key, JSON.stringify(value))\n      })\n      \n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { getDatabase } from '../database'\nimport https from 'https'\nimport http from 'http'\n\ninterface AIConfig {\n  baseUrl: string\n  apiKey: string\n  model: string\n}\n\ninterface ChatMessage {\n  role: 'system' | 'user' | 'assistant'\n  content: string\n}\n\n// å½“å‰æ´»è·ƒçš„è¯·æ±‚ï¼Œç”¨äºå–æ¶ˆ\nlet activeRequest: any = null\n\nfunction getAIConfig(): AIConfig {\n  const db = getDatabase()\n  const rows = db.prepare('SELECT key, value FROM settings WHERE key LIKE ?').all('ai_%') as { key: string; value: string }[]\n  const config: Record<string, string> = {}\n  rows.forEach((r: { key: string; value: string }) => {\n    try { config[r.key] = JSON.parse(r.value) } catch { config[r.key] = r.value }\n  })\n  return {\n    baseUrl: config['ai_base_url'] || 'https://api.deepseek.com',\n    apiKey: config['ai_api_key'] || 'sk-376363b4a79e4bb5ae5f329706efc0f4',\n    model: config['ai_model'] || 'deepseek-chat',\n  }\n}\n\nexport async function aiChat(messages: ChatMessage[], systemPrompt?: string): Promise<string> {\n  const config = getAIConfig()\n  if (!config.apiKey) throw new Error('è¯·å…ˆåœ¨è®¾ç½®ä¸­é…ç½® AI API Key')\n\n  const allMessages: ChatMessage[] = []\n  if (systemPrompt) {\n    allMessages.push({ role: 'system', content: systemPrompt })\n  }\n  allMessages.push(...messages)\n\n  const body = JSON.stringify({\n    model: config.model,\n    messages: allMessages,\n    temperature: 0.7,\n    max_tokens: 2048,\n  })\n\n  return new Promise((resolve, reject) => {\n    const url = new URL(config.baseUrl.replace(/\\/$/, '') + '/chat/completions')\n    const isHttps = url.protocol === 'https:'\n    const transport = isHttps ? https : http\n\n    const req = transport.request({\n      hostname: url.hostname,\n      port: url.port || (isHttps ? 443 : 80),\n      path: url.pathname + url.search,\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${config.apiKey}`,\n      },\n    }, (res) => {\n      let data = ''\n      res.on('data', (chunk: Buffer) => { data += chunk.toString() })\n      res.on('end', () => {\n        try {\n          const json = JSON.parse(data)\n          if (json.error) {\n            reject(new Error(json.error.message || JSON.stringify(json.error)))\n            return\n          }\n          resolve(json.choices?.[0]?.message?.content || '')\n        } catch (e) {\n          reject(new Error('AI å“åº”è§£æå¤±è´¥: ' + data.slice(0, 200)))\n        }\n      })\n    })\n\n    activeRequest = req\n    req.on('error', (e: Error) => reject(new Error('AI è¯·æ±‚å¤±è´¥: ' + e.message)))\n    req.write(body)\n    req.end()\n  })\n}\n\nexport async function aiChatStream(\n  messages: ChatMessage[],\n  systemPrompt: string | undefined,\n  onChunk: (text: string) => void,\n  onDone: () => void,\n  onError: (err: string) => void\n): Promise<void> {\n  const config = getAIConfig()\n  if (!config.apiKey) {\n    onError('è¯·å…ˆåœ¨è®¾ç½®ä¸­é…ç½® AI API Key')\n    return\n  }\n\n  const allMessages: ChatMessage[] = []\n  if (systemPrompt) {\n    allMessages.push({ role: 'system', content: systemPrompt })\n  }\n  allMessages.push(...messages)\n\n  const body = JSON.stringify({\n    model: config.model,\n    messages: allMessages,\n    temperature: 0.7,\n    max_tokens: 2048,\n    stream: true,\n  })\n\n  const url = new URL(config.baseUrl.replace(/\\/$/, '') + '/chat/completions')\n  const isHttps = url.protocol === 'https:'\n  const transport = isHttps ? https : http\n\n  const req = transport.request({\n    hostname: url.hostname,\n    port: url.port || (isHttps ? 443 : 80),\n    path: url.pathname + url.search,\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${config.apiKey}`,\n    },\n  }, (res) => {\n    let buffer = ''\n    res.on('data', (chunk: Buffer) => {\n      buffer += chunk.toString()\n      const lines = buffer.split('\\n')\n      buffer = lines.pop() || ''\n\n      for (const line of lines) {\n        const trimmed = line.trim()\n        if (!trimmed || !trimmed.startsWith('data: ')) continue\n        const data = trimmed.slice(6)\n        if (data === '[DONE]') {\n          onDone()\n          return\n        }\n        try {\n          const json = JSON.parse(data)\n          const content = json.choices?.[0]?.delta?.content\n          if (content) onChunk(content)\n        } catch {\n          // ignore parse errors in stream\n        }\n      }\n    })\n    res.on('end', () => onDone())\n  })\n\n  activeRequest = req\n  req.on('error', (e: Error) => onError('AI è¯·æ±‚å¤±è´¥: ' + e.message))\n  req.write(body)\n  req.end()\n}\n\nexport function aiStop() {\n  if (activeRequest) {\n    activeRequest.destroy()\n    activeRequest = null\n  }\n}\n\n// --- Utility AI functions ---\n\nconst SYSTEM_PROMPTS = {\n  summarize: 'ä½ æ˜¯ä¸€ä¸ªçŸ¥è¯†åº“åŠ©æ‰‹ã€‚è¯·ç”¨ç®€æ´çš„è¯­è¨€æ€»ç»“ä»¥ä¸‹å†…å®¹ï¼Œæå–æ ¸å¿ƒè¦ç‚¹ã€‚ç”¨ä¸­æ–‡å›ç­”ã€‚',\n  suggestTags: 'ä½ æ˜¯ä¸€ä¸ªçŸ¥è¯†åº“åŠ©æ‰‹ã€‚è¯·æ ¹æ®ä»¥ä¸‹å†…å®¹å»ºè®® 3-5 ä¸ªåˆé€‚çš„æ ‡ç­¾ã€‚åªè¾“å‡ºæ ‡ç­¾åï¼Œç”¨é€—å·åˆ†éš”ï¼Œä¸è¦å…¶ä»–å†…å®¹ã€‚ç”¨ä¸­æ–‡å›ç­”ã€‚',\n  polish: 'ä½ æ˜¯ä¸€ä¸ªå†™ä½œåŠ©æ‰‹ã€‚è¯·æ¶¦è‰²ä»¥ä¸‹æ–‡å­—ï¼Œä½¿å…¶æ›´åŠ é€šé¡ºã€ä¸“ä¸šï¼Œä¿æŒåŸæ„ä¸å˜ã€‚ç›´æ¥è¾“å‡ºæ¶¦è‰²åçš„å†…å®¹ï¼Œä¸è¦å…¶ä»–è¯´æ˜ã€‚',\n  continue: 'ä½ æ˜¯ä¸€ä¸ªå†™ä½œåŠ©æ‰‹ã€‚è¯·æ ¹æ®ä»¥ä¸‹å†…å®¹ç»§ç»­å¾€ä¸‹å†™ï¼Œä¿æŒé£æ ¼ä¸€è‡´ï¼Œè‡ªç„¶åœ°æ‰©å±•å†…å®¹ã€‚ç›´æ¥è¾“å‡ºç»­å†™å†…å®¹ï¼Œä¸è¦é‡å¤å·²æœ‰å†…å®¹ã€‚',\n  translate: 'ä½ æ˜¯ä¸€ä¸ªç¿»è¯‘åŠ©æ‰‹ã€‚è¯·å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆ{lang}ã€‚ç›´æ¥è¾“å‡ºç¿»è¯‘ç»“æœï¼Œä¸è¦å…¶ä»–è¯´æ˜ã€‚',\n  explain: 'ä½ æ˜¯ä¸€ä¸ªçŸ¥è¯†åº“åŠ©æ‰‹ã€‚è¯·ç”¨é€šä¿—æ˜“æ‡‚çš„è¯­è¨€è§£é‡Šä»¥ä¸‹å†…å®¹ã€‚ç”¨ä¸­æ–‡å›ç­”ã€‚',\n  searchEnhance: 'ä½ æ˜¯ä¸€ä¸ªæœç´¢åŠ©æ‰‹ã€‚ç”¨æˆ·æƒ³æœç´¢ä»¥ä¸‹å†…å®¹ï¼Œè¯·å¸®å¿™æ‰©å±•æœç´¢å…³é”®è¯ï¼Œç”Ÿæˆ 3-5 ä¸ªç›¸å…³çš„æœç´¢è¯ã€‚åªè¾“å‡ºå…³é”®è¯ï¼Œç”¨é€—å·åˆ†éš”ã€‚',\n  knowledgeChat: 'ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½çŸ¥è¯†åº“åŠ©æ‰‹ã€‚ç”¨æˆ·ä¼šå‘ä½ æé—®å…³äºä»–ä»¬çŸ¥è¯†åº“ä¸­å†…å®¹çš„é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯ç›¸å…³çš„çŸ¥è¯†åº“å†…å®¹ï¼Œè¯·åŸºäºè¿™äº›å†…å®¹å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å¦‚æœçŸ¥è¯†åº“ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œè¯·å¦‚å®å‘ŠçŸ¥ã€‚ç”¨ä¸­æ–‡å›ç­”ã€‚',\n}\n\nexport async function aiSummarize(content: string): Promise<string> {\n  return aiChat([{ role: 'user', content }], SYSTEM_PROMPTS.summarize)\n}\n\nexport async function aiSuggestTags(content: string): Promise<string[]> {\n  const result = await aiChat([{ role: 'user', content }], SYSTEM_PROMPTS.suggestTags)\n  return result.split(/[,ï¼Œã€]/).map(t => t.trim()).filter(Boolean)\n}\n\nexport async function aiPolish(content: string): Promise<string> {\n  return aiChat([{ role: 'user', content }], SYSTEM_PROMPTS.polish)\n}\n\nexport async function aiContinue(content: string): Promise<string> {\n  return aiChat([{ role: 'user', content }], SYSTEM_PROMPTS.continue)\n}\n\nexport async function aiTranslate(content: string, lang: string): Promise<string> {\n  const prompt = SYSTEM_PROMPTS.translate.replace('{lang}', lang)\n  return aiChat([{ role: 'user', content }], prompt)\n}\n\nexport async function aiExplain(content: string): Promise<string> {\n  return aiChat([{ role: 'user', content }], SYSTEM_PROMPTS.explain)\n}\n\nexport async function aiSearchEnhance(query: string): Promise<string[]> {\n  const result = await aiChat([{ role: 'user', content: query }], SYSTEM_PROMPTS.searchEnhance)\n  return result.split(/[,ï¼Œã€]/).map(t => t.trim()).filter(Boolean)\n}\n\nexport { SYSTEM_PROMPTS }\nexport type { ChatMessage, AIConfig }\n","import { ipcMain, BrowserWindow } from 'electron'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\nimport {\n  aiChat,\n  aiChatStream,\n  aiStop,\n  aiSummarize,\n  aiSuggestTags,\n  aiPolish,\n  aiContinue,\n  aiTranslate,\n  aiExplain,\n  aiSearchEnhance,\n  SYSTEM_PROMPTS,\n} from './service'\nimport type { ChatMessage } from './service'\n\nexport function registerAIHandlers() {\n  const db = getDatabase()\n\n  // åˆå§‹åŒ– AI èŠå¤©å†å²è¡¨\n  db.exec(`\n    CREATE TABLE IF NOT EXISTS ai_conversations (\n      id TEXT PRIMARY KEY,\n      title TEXT NOT NULL DEFAULT 'æ–°å¯¹è¯',\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP\n    )\n  `)\n  db.exec(`\n    CREATE TABLE IF NOT EXISTS ai_messages (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      conversation_id TEXT NOT NULL,\n      role TEXT NOT NULL,\n      content TEXT NOT NULL,\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (conversation_id) REFERENCES ai_conversations(id) ON DELETE CASCADE\n    )\n  `)\n\n  // éæµå¼èŠå¤©\n  ipcMain.handle(IPC_CHANNELS.AI_CHAT, async (_event, messages: ChatMessage[], systemPrompt?: string) => {\n    try {\n      const result = await aiChat(messages, systemPrompt)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // æµå¼èŠå¤©\n  ipcMain.handle(IPC_CHANNELS.AI_CHAT_STREAM, async (event, messages: ChatMessage[], systemPrompt?: string) => {\n    try {\n      const win = BrowserWindow.fromWebContents(event.sender)\n      await aiChatStream(\n        messages,\n        systemPrompt,\n        (text) => {\n          if (win && !win.isDestroyed()) {\n            win.webContents.send('ai:stream:chunk', text)\n          }\n        },\n        () => {\n          if (win && !win.isDestroyed()) {\n            win.webContents.send('ai:stream:done')\n          }\n        },\n        (err) => {\n          if (win && !win.isDestroyed()) {\n            win.webContents.send('ai:stream:error', err)\n          }\n        }\n      )\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // åœæ­¢ç”Ÿæˆ\n  ipcMain.handle(IPC_CHANNELS.AI_STOP, async () => {\n    aiStop()\n    return { success: true }\n  })\n\n  // æ€»ç»“\n  ipcMain.handle(IPC_CHANNELS.AI_SUMMARIZE, async (_event, content: string) => {\n    try {\n      const result = await aiSummarize(content)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // å»ºè®®æ ‡ç­¾\n  ipcMain.handle(IPC_CHANNELS.AI_SUGGEST_TAGS, async (_event, content: string) => {\n    try {\n      const result = await aiSuggestTags(content)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // æ¶¦è‰²\n  ipcMain.handle(IPC_CHANNELS.AI_POLISH, async (_event, content: string) => {\n    try {\n      const result = await aiPolish(content)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ç»­å†™\n  ipcMain.handle(IPC_CHANNELS.AI_CONTINUE, async (_event, content: string) => {\n    try {\n      const result = await aiContinue(content)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ç¿»è¯‘\n  ipcMain.handle(IPC_CHANNELS.AI_TRANSLATE, async (_event, content: string, lang: string) => {\n    try {\n      const result = await aiTranslate(content, lang)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // è§£é‡Š\n  ipcMain.handle(IPC_CHANNELS.AI_EXPLAIN, async (_event, content: string) => {\n    try {\n      const result = await aiExplain(content)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // æœç´¢å¢å¼º\n  ipcMain.handle(IPC_CHANNELS.AI_SEARCH_ENHANCE, async (_event, query: string) => {\n    try {\n      const result = await aiSearchEnhance(query)\n      return { success: true, data: result }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // èŠå¤©å†å² - åˆ—è¡¨\n  ipcMain.handle(IPC_CHANNELS.AI_CHAT_HISTORY_LIST, async () => {\n    try {\n      const rows = db.prepare('SELECT * FROM ai_conversations ORDER BY updated_at DESC').all()\n      return { success: true, data: rows }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // èŠå¤©å†å² - è·å–\n  ipcMain.handle(IPC_CHANNELS.AI_CHAT_HISTORY_GET, async (_event, conversationId: string) => {\n    try {\n      const messages = db.prepare('SELECT * FROM ai_messages WHERE conversation_id = ? ORDER BY created_at ASC').all(conversationId)\n      return { success: true, data: messages }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // èŠå¤©å†å² - ä¿å­˜\n  ipcMain.handle(IPC_CHANNELS.AI_CHAT_HISTORY_SAVE, async (_event, conversationId: string, title: string, messages: { role: string; content: string }[]) => {\n    try {\n      // upsert conversation\n      db.prepare(`\n        INSERT INTO ai_conversations (id, title, updated_at) VALUES (?, ?, CURRENT_TIMESTAMP)\n        ON CONFLICT(id) DO UPDATE SET title = ?, updated_at = CURRENT_TIMESTAMP\n      `).run(conversationId, title, title)\n\n      // delete old messages and re-insert\n      db.prepare('DELETE FROM ai_messages WHERE conversation_id = ?').run(conversationId)\n      const insert = db.prepare('INSERT INTO ai_messages (conversation_id, role, content) VALUES (?, ?, ?)')\n      for (const msg of messages) {\n        insert.run(conversationId, msg.role, msg.content)\n      }\n\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // èŠå¤©å†å² - åˆ é™¤\n  ipcMain.handle(IPC_CHANNELS.AI_CHAT_HISTORY_DELETE, async (_event, conversationId: string) => {\n    try {\n      db.prepare('DELETE FROM ai_conversations WHERE id = ?').run(conversationId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain, dialog, shell } from 'electron'\nimport { IPC_CHANNELS } from '../constants'\nimport * as fs from 'fs'\nimport * as path from 'path'\nimport { v4 as uuidv4 } from 'uuid'\nimport { getDatabase } from '../database'\nimport { globalContext } from '../context'\n\nexport function registerDialogHandlers() {\n  ipcMain.handle('dialog:openDirectory', async () => {\n    const result = await dialog.showOpenDialog({\n      properties: ['openDirectory', 'createDirectory']\n    })\n    \n    if (result.canceled) {\n      return null\n    }\n    \n    return result.filePaths[0]\n  })\n\n  // è®¾ç½®å½“å‰å·¥ä½œåŒºå¹¶åŒæ­¥æ–‡ä»¶\n  ipcMain.handle('workspace:set', async (_event, workspacePath: string) => {\n    console.log('[Main] Setting workspace:', workspacePath)\n    globalContext.currentWorkspace = workspacePath\n    \n    // ç«‹å³æ‰«æå¹¶åŒæ­¥\n    try {\n      if (!fs.existsSync(workspacePath)) return false\n      \n      const db = getDatabase()\n      const files = fs.readdirSync(workspacePath)\n      const mdFiles = files.filter(f => f.endsWith('.md'))\n      \n      console.log(`[Main] Found ${mdFiles.length} markdown files to sync`)\n      \n      const now = new Date().toISOString()\n      \n      // ç®€å•åŒæ­¥é€»è¾‘ï¼šå¦‚æœ DB é‡Œæ²¡æœ‰åŒåæ–‡ä»¶ï¼Œå°±æ’å…¥\n      // å¦‚æœ DB é‡Œæœ‰ï¼Œä½†æ–‡ä»¶å†…å®¹å˜äº†ï¼Œå°±æ›´æ–° DB (ç®€åŒ–èµ·è§å…ˆåªåšå¯¼å…¥)\n      for (const file of mdFiles) {\n        const title = path.basename(file, '.md')\n        const content = fs.readFileSync(path.join(workspacePath, file), 'utf-8')\n        \n        // æ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼ˆæŒ‰ titleï¼‰\n        const existing = db.prepare('SELECT id FROM notes WHERE title = ?').get(title) as any\n        \n        if (!existing) {\n          const id = uuidv4()\n          db.prepare(`\n            INSERT INTO notes (id, title, content, type, created_at, updated_at)\n            VALUES (?, ?, ?, ?, ?, ?)\n          `).run(id, title, content, 'markdown', now, now)\n          console.log(`[Main] Imported note: ${title}`)\n        } else {\n           // å¯é€‰ï¼šæ›´æ–°å†…å®¹\n           // db.prepare('UPDATE notes SET content = ? WHERE id = ?').run(content, existing.id)\n        }\n      }\n      return true\n    } catch (e) {\n      console.error('[Main] Sync failed:', e)\n      return false\n    }\n  })\n\n  // åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ˜¾ç¤º\n  ipcMain.handle(IPC_CHANNELS.SYSTEM_REVEAL, async (_event, filePath: string) => {\n    try {\n      if (fs.existsSync(filePath)) {\n        shell.showItemInFolder(filePath)\n        return true\n      }\n      return false\n    } catch (e) {\n      console.error('[Main] Reveal failed:', e)\n      return false\n    }\n  })\n}\n","import { registerNoteHandlers } from './notes'\nimport { registerFolderHandlers } from './folders'\nimport { registerTagHandlers } from './tags'\nimport { registerLinkHandlers } from './links'\nimport { registerSettingsHandlers } from './settings'\nimport { registerAIHandlers } from '../ai'\n\nimport { registerDialogHandlers } from './dialog'\n\nexport function registerAllHandlers() {\n  registerNoteHandlers()\n  registerFolderHandlers()\n  registerTagHandlers()\n  registerLinkHandlers()\n  registerSettingsHandlers()\n  registerAIHandlers()\n  registerDialogHandlers()\n}\n","import { app, BrowserWindow } from 'electron'\nimport { createRequire } from 'node:module'\nimport { fileURLToPath } from 'node:url'\nimport path from 'node:path'\nimport { initDatabase, closeDatabase } from './database'\nimport { registerAllHandlers } from './ipc'\n\nconst require = createRequire(import.meta.url)\nconst __dirname = path.dirname(fileURLToPath(import.meta.url))\n\n// The built directory structure\n//\n// â”œâ”€â”¬â”€â”¬ dist\n// â”‚ â”‚ â””â”€â”€ index.html\n// â”‚ â”‚\n// â”‚ â”œâ”€â”¬ dist-electron\n// â”‚ â”‚ â”œâ”€â”€ main.js\n// â”‚ â”‚ â””â”€â”€ preload.mjs\n// â”‚\nprocess.env.APP_ROOT = path.join(__dirname, '..')\n\n// ğŸš§ Use ['ENV_NAME'] avoid vite:define plugin - Vite@2.x\nexport const VITE_DEV_SERVER_URL = process.env['VITE_DEV_SERVER_URL']\nexport const MAIN_DIST = path.join(process.env.APP_ROOT, 'dist-electron')\nexport const RENDERER_DIST = path.join(process.env.APP_ROOT, 'dist')\n\nprocess.env.VITE_PUBLIC = VITE_DEV_SERVER_URL ? path.join(process.env.APP_ROOT, 'public') : RENDERER_DIST\n\nlet win: BrowserWindow | null\n\nfunction createWindow() {\n  win = new BrowserWindow({\n    width: 1400,\n    height: 900,\n    minWidth: 1000,\n    minHeight: 600,\n    icon: path.join(process.env.VITE_PUBLIC, 'electron-vite.svg'),\n    titleBarStyle: 'hiddenInset',\n    trafficLightPosition: { x: 16, y: 16 },\n    webPreferences: {\n      preload: path.join(__dirname, 'preload.mjs'),\n      nodeIntegration: false,\n      contextIsolation: true,\n    },\n  })\n\n  // Test active push message to Renderer-process.\n  win.webContents.on('did-finish-load', () => {\n    win?.webContents.send('main-process-message', (new Date).toLocaleString())\n  })\n\n  if (VITE_DEV_SERVER_URL) {\n    win.loadURL(VITE_DEV_SERVER_URL)\n  } else {\n    // win.loadFile('dist/index.html')\n    win.loadFile(path.join(RENDERER_DIST, 'index.html'))\n  }\n}\n\n// Quit when all windows are closed, except on macOS. There, it's common\n// for applications and their menu bar to stay active until the user quits\n// explicitly with Cmd + Q.\napp.on('window-all-closed', () => {\n  if (process.platform !== 'darwin') {\n    app.quit()\n    win = null\n  }\n})\n\napp.on('activate', () => {\n  // On OS X it's common to re-create a window in the app when the\n  // dock icon is clicked and there are no other windows open.\n  if (BrowserWindow.getAllWindows().length === 0) {\n    createWindow()\n  }\n})\n\n// åº”ç”¨é€€å‡ºæ—¶å…³é—­æ•°æ®åº“\napp.on('before-quit', () => {\n  closeDatabase()\n})\n\napp.whenReady().then(() => {\n  // åˆå§‹åŒ–æ•°æ®åº“\n  initDatabase()\n  // æ³¨å†Œæ‰€æœ‰ IPC å¤„ç†å™¨\n  registerAllHandlers()\n  // åˆ›å»ºçª—å£\n  createWindow()\n})\n"],"names":["require","db","uuidv4","win","createRequire","__dirname","path"],"mappings":"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","x_google_ignoreList":[1,2,3,4]}