{"version":3,"file":"main.js","sources":["../electron/database/index.ts","../node_modules/uuid/dist-node/stringify.js","../node_modules/uuid/dist-node/rng.js","../node_modules/uuid/dist-node/native.js","../node_modules/uuid/dist-node/v4.js","../electron/constants.ts","../electron/ipc/notes.ts","../electron/ipc/folders.ts","../electron/ipc/tags.ts","../electron/ipc/links.ts","../electron/ipc/settings.ts","../electron/ipc/index.ts","../electron/main.ts"],"sourcesContent":["import { app } from 'electron'\nimport * as path from 'path'\nimport * as fs from 'fs'\nimport { createRequire } from 'module'\n\n// ‰ΩøÁî® createRequire Âä†ËΩΩÂéüÁîüÊ®°Âùó\nconst require = createRequire(import.meta.url)\nconst Database = require('better-sqlite3')\n\ntype DatabaseType = ReturnType<typeof Database>\nlet db: DatabaseType | null = null\n\nexport function getDatabase(): DatabaseType {\n  if (!db) {\n    throw new Error('Database not initialized')\n  }\n  return db\n}\n\nexport function initDatabase(): DatabaseType {\n  const userDataPath = app.getPath('userData')\n  const dbPath = path.join(userDataPath, 'knowledge.db')\n  \n  // Á°Æ‰øùÁõÆÂΩïÂ≠òÂú®\n  if (!fs.existsSync(userDataPath)) {\n    fs.mkdirSync(userDataPath, { recursive: true })\n  }\n  \n  db = new Database(dbPath)\n  \n  // ÂêØÁî®Â§ñÈîÆÁ∫¶Êùü\n  db.pragma('foreign_keys = ON')\n  \n  // ÂàõÂª∫Ë°®ÁªìÊûÑ\n  const schema = `\n    -- Á¨îËÆ∞/ÊñáÊ°£Ë°®\n    CREATE TABLE IF NOT EXISTS notes (\n      id TEXT PRIMARY KEY,\n      title TEXT NOT NULL,\n      content TEXT DEFAULT '',\n      type TEXT CHECK(type IN ('markdown', 'bookmark', 'snippet')) NOT NULL DEFAULT 'markdown',\n      folder_id TEXT,\n      url TEXT,\n      favicon TEXT,\n      description TEXT,\n      language TEXT,\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (folder_id) REFERENCES folders(id) ON DELETE SET NULL\n    );\n\n    -- Ê†áÁ≠æË°®\n    CREATE TABLE IF NOT EXISTS tags (\n      id TEXT PRIMARY KEY,\n      name TEXT UNIQUE NOT NULL,\n      color TEXT DEFAULT '#409EFF'\n    );\n\n    -- Á¨îËÆ∞-Ê†áÁ≠æÂÖ≥ËÅîË°®\n    CREATE TABLE IF NOT EXISTS note_tags (\n      note_id TEXT NOT NULL,\n      tag_id TEXT NOT NULL,\n      PRIMARY KEY (note_id, tag_id),\n      FOREIGN KEY (note_id) REFERENCES notes(id) ON DELETE CASCADE,\n      FOREIGN KEY (tag_id) REFERENCES tags(id) ON DELETE CASCADE\n    );\n\n    -- ÂèåÂêëÈìæÊé•Ë°®\n    CREATE TABLE IF NOT EXISTS links (\n      source_id TEXT NOT NULL,\n      target_id TEXT NOT NULL,\n      PRIMARY KEY (source_id, target_id),\n      FOREIGN KEY (source_id) REFERENCES notes(id) ON DELETE CASCADE,\n      FOREIGN KEY (target_id) REFERENCES notes(id) ON DELETE CASCADE\n    );\n\n    -- Êñá‰ª∂Â§πË°®\n    CREATE TABLE IF NOT EXISTS folders (\n      id TEXT PRIMARY KEY,\n      name TEXT NOT NULL,\n      parent_id TEXT,\n      sort_order INTEGER DEFAULT 0,\n      FOREIGN KEY (parent_id) REFERENCES folders(id) ON DELETE CASCADE\n    );\n\n    -- ËÆæÁΩÆË°®\n    CREATE TABLE IF NOT EXISTS settings (\n      key TEXT PRIMARY KEY,\n      value TEXT\n    );\n  `\n  \n  db.exec(schema)\n  \n  // ÂàõÂª∫ÂÖ®ÊñáÊêúÁ¥¢Ë°®ÔºàÂ¶ÇÊûú‰∏çÂ≠òÂú®Ôºâ\n  try {\n    db.exec(`\n      CREATE VIRTUAL TABLE IF NOT EXISTS notes_fts USING fts5(\n        title,\n        content,\n        content='notes',\n        content_rowid='rowid'\n      );\n    `)\n  } catch (e) {\n    // FTSË°®ÂèØËÉΩÂ∑≤Â≠òÂú®\n  }\n  \n  // ÂàõÂª∫Ëß¶ÂèëÂô®\n  try {\n    db.exec(`\n      CREATE TRIGGER IF NOT EXISTS notes_ai AFTER INSERT ON notes BEGIN\n        INSERT INTO notes_fts(rowid, title, content) VALUES (NEW.rowid, NEW.title, NEW.content);\n      END;\n    `)\n    db.exec(`\n      CREATE TRIGGER IF NOT EXISTS notes_au AFTER UPDATE ON notes BEGIN\n        INSERT INTO notes_fts(notes_fts, rowid, title, content) VALUES('delete', OLD.rowid, OLD.title, OLD.content);\n        INSERT INTO notes_fts(rowid, title, content) VALUES (NEW.rowid, NEW.title, NEW.content);\n      END;\n    `)\n    db.exec(`\n      CREATE TRIGGER IF NOT EXISTS notes_ad AFTER DELETE ON notes BEGIN\n        INSERT INTO notes_fts(notes_fts, rowid, title, content) VALUES('delete', OLD.rowid, OLD.title, OLD.content);\n      END;\n    `)\n  } catch (e) {\n    // Ëß¶ÂèëÂô®ÂèØËÉΩÂ∑≤Â≠òÂú®\n  }\n  \n  // ÂàõÂª∫Á¥¢Âºï\n  try {\n    db.exec(`\n      CREATE INDEX IF NOT EXISTS idx_notes_folder ON notes(folder_id);\n      CREATE INDEX IF NOT EXISTS idx_notes_type ON notes(type);\n      CREATE INDEX IF NOT EXISTS idx_notes_updated ON notes(updated_at DESC);\n      CREATE INDEX IF NOT EXISTS idx_folders_parent ON folders(parent_id);\n      CREATE INDEX IF NOT EXISTS idx_note_tags_note ON note_tags(note_id);\n      CREATE INDEX IF NOT EXISTS idx_note_tags_tag ON note_tags(tag_id);\n      CREATE INDEX IF NOT EXISTS idx_links_source ON links(source_id);\n      CREATE INDEX IF NOT EXISTS idx_links_target ON links(target_id);\n    `)\n  } catch (e) {\n    // Á¥¢ÂºïÂèØËÉΩÂ∑≤Â≠òÂú®\n  }\n  \n  return db\n}\n\nexport function closeDatabase() {\n  if (db) {\n    db.close()\n    db = null\n  }\n}\n","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","import { randomFillSync } from 'node:crypto';\nconst rnds8Pool = new Uint8Array(256);\nlet poolPtr = rnds8Pool.length;\nexport default function rng() {\n    if (poolPtr > rnds8Pool.length - 16) {\n        randomFillSync(rnds8Pool);\n        poolPtr = 0;\n    }\n    return rnds8Pool.slice(poolPtr, (poolPtr += 16));\n}\n","import { randomUUID } from 'node:crypto';\nexport default { randomUUID };\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction _v4(options, buf, offset) {\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    return _v4(options, buf, offset);\n}\nexport default v4;\n","// IPC ÈÄöÈÅìÂêçÁß∞\nexport const IPC_CHANNELS = {\n  // Êï∞ÊçÆÂ∫ìÊìç‰Ωú\n  DB_INIT: 'db:init',\n  DB_QUERY: 'db:query',\n  DB_RUN: 'db:run',\n  \n  // Á¨îËÆ∞Êìç‰Ωú\n  NOTE_CREATE: 'note:create',\n  NOTE_UPDATE: 'note:update',\n  NOTE_DELETE: 'note:delete',\n  NOTE_GET: 'note:get',\n  NOTE_LIST: 'note:list',\n  NOTE_SEARCH: 'note:search',\n  \n  // Êñá‰ª∂Â§πÊìç‰Ωú\n  FOLDER_CREATE: 'folder:create',\n  FOLDER_UPDATE: 'folder:update',\n  FOLDER_DELETE: 'folder:delete',\n  FOLDER_LIST: 'folder:list',\n  \n  // Ê†áÁ≠æÊìç‰Ωú\n  TAG_CREATE: 'tag:create',\n  TAG_UPDATE: 'tag:update',\n  TAG_DELETE: 'tag:delete',\n  TAG_LIST: 'tag:list',\n  TAG_ADD_TO_NOTE: 'tag:addToNote',\n  TAG_REMOVE_FROM_NOTE: 'tag:removeFromNote',\n  \n  // ÈìæÊé•Êìç‰Ωú\n  LINK_CREATE: 'link:create',\n  LINK_DELETE: 'link:delete',\n  LINK_GET_BY_NOTE: 'link:getByNote',\n  LINK_GET_GRAPH: 'link:getGraph',\n  \n  // Êñá‰ª∂Êìç‰Ωú\n  FILE_READ: 'file:read',\n  FILE_WRITE: 'file:write',\n  FILE_DELETE: 'file:delete',\n  \n  // ËÆæÁΩÆ\n  SETTINGS_GET: 'settings:get',\n  SETTINGS_SET: 'settings:set',\n} as const\n","import { ipcMain } from 'electron'\nimport { v4 as uuidv4 } from 'uuid'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\ninterface NoteRow {\n  id: string\n  title: string\n  content: string\n  type: string\n  folder_id: string | null\n  url: string | null\n  favicon: string | null\n  description: string | null\n  language: string | null\n  created_at: string\n  updated_at: string\n}\n\nfunction rowToNote(row: NoteRow) {\n  return {\n    id: row.id,\n    title: row.title,\n    content: row.content,\n    type: row.type as 'markdown' | 'bookmark' | 'snippet',\n    folderId: row.folder_id,\n    url: row.url || undefined,\n    favicon: row.favicon || undefined,\n    description: row.description || undefined,\n    language: row.language || undefined,\n    createdAt: row.created_at,\n    updatedAt: row.updated_at,\n  }\n}\n\nexport function registerNoteHandlers() {\n  const db = getDatabase()\n\n  // ÂàõÂª∫Á¨îËÆ∞\n  ipcMain.handle(IPC_CHANNELS.NOTE_CREATE, async (_event, note) => {\n    try {\n      const id = uuidv4()\n      const now = new Date().toISOString()\n      \n      const stmt = db.prepare(`\n        INSERT INTO notes (id, title, content, type, folder_id, url, favicon, description, language, created_at, updated_at)\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      `)\n      \n      stmt.run(\n        id,\n        note.title || 'Êó†Ê†áÈ¢ò',\n        note.content || '',\n        note.type || 'markdown',\n        note.folderId || null,\n        note.url || null,\n        note.favicon || null,\n        note.description || null,\n        note.language || null,\n        now,\n        now\n      )\n      \n      const created = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow\n      return { success: true, data: rowToNote(created) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Êõ¥Êñ∞Á¨îËÆ∞\n  ipcMain.handle(IPC_CHANNELS.NOTE_UPDATE, async (_event, id, updates) => {\n    try {\n      const fields: string[] = []\n      const values: any[] = []\n      \n      if (updates.title !== undefined) {\n        fields.push('title = ?')\n        values.push(updates.title)\n      }\n      if (updates.content !== undefined) {\n        fields.push('content = ?')\n        values.push(updates.content)\n      }\n      if (updates.folderId !== undefined) {\n        fields.push('folder_id = ?')\n        values.push(updates.folderId)\n      }\n      if (updates.url !== undefined) {\n        fields.push('url = ?')\n        values.push(updates.url)\n      }\n      if (updates.favicon !== undefined) {\n        fields.push('favicon = ?')\n        values.push(updates.favicon)\n      }\n      if (updates.description !== undefined) {\n        fields.push('description = ?')\n        values.push(updates.description)\n      }\n      if (updates.language !== undefined) {\n        fields.push('language = ?')\n        values.push(updates.language)\n      }\n      \n      fields.push('updated_at = ?')\n      values.push(new Date().toISOString())\n      values.push(id)\n      \n      const stmt = db.prepare(`UPDATE notes SET ${fields.join(', ')} WHERE id = ?`)\n      stmt.run(...values)\n      \n      const updated = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow\n      return { success: true, data: rowToNote(updated) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Âà†Èô§Á¨îËÆ∞\n  ipcMain.handle(IPC_CHANNELS.NOTE_DELETE, async (_event, id) => {\n    try {\n      db.prepare('DELETE FROM notes WHERE id = ?').run(id)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Ëé∑ÂèñÂçï‰∏™Á¨îËÆ∞\n  ipcMain.handle(IPC_CHANNELS.NOTE_GET, async (_event, id) => {\n    try {\n      const row = db.prepare('SELECT * FROM notes WHERE id = ?').get(id) as NoteRow | undefined\n      if (row) {\n        return { success: true, data: rowToNote(row) }\n      }\n      return { success: false, error: 'Note not found' }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Ëé∑ÂèñÁ¨îËÆ∞ÂàóË°®\n  ipcMain.handle(IPC_CHANNELS.NOTE_LIST, async (_event, filters = {}) => {\n    try {\n      let sql = 'SELECT * FROM notes WHERE 1=1'\n      const params: any[] = []\n      \n      if (filters.type) {\n        sql += ' AND type = ?'\n        params.push(filters.type)\n      }\n      if (filters.folderId !== undefined) {\n        if (filters.folderId === null) {\n          sql += ' AND folder_id IS NULL'\n        } else {\n          sql += ' AND folder_id = ?'\n          params.push(filters.folderId)\n        }\n      }\n      \n      sql += ' ORDER BY updated_at DESC'\n      \n      const rows = db.prepare(sql).all(...params) as NoteRow[]\n      return { success: true, data: rows.map(rowToNote) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ÊêúÁ¥¢Á¨îËÆ∞\n  ipcMain.handle(IPC_CHANNELS.NOTE_SEARCH, async (_event, query) => {\n    try {\n      if (!query || query.trim() === '') {\n        return { success: true, data: [] }\n      }\n      \n      const rows = db.prepare(`\n        SELECT n.*, \n               snippet(notes_fts, 0, '<mark>', '</mark>', '...', 32) as title_highlight,\n               snippet(notes_fts, 1, '<mark>', '</mark>', '...', 64) as content_highlight\n        FROM notes_fts fts\n        JOIN notes n ON n.rowid = fts.rowid\n        WHERE notes_fts MATCH ?\n        ORDER BY rank\n        LIMIT 50\n      `).all(query) as any[]\n      \n      const results = rows.map(row => ({\n        note: rowToNote(row),\n        highlights: [row.title_highlight, row.content_highlight].filter(Boolean),\n        score: 0,\n      }))\n      \n      return { success: true, data: results }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { v4 as uuidv4 } from 'uuid'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\ninterface FolderRow {\n  id: string\n  name: string\n  parent_id: string | null\n  sort_order: number\n}\n\nfunction rowToFolder(row: FolderRow) {\n  return {\n    id: row.id,\n    name: row.name,\n    parentId: row.parent_id,\n    sortOrder: row.sort_order,\n  }\n}\n\nexport function registerFolderHandlers() {\n  const db = getDatabase()\n\n  // ÂàõÂª∫Êñá‰ª∂Â§π\n  ipcMain.handle(IPC_CHANNELS.FOLDER_CREATE, async (_event, folder) => {\n    try {\n      const id = uuidv4()\n      \n      // Ëé∑ÂèñÂêåÁ∫ßÊñá‰ª∂Â§π‰∏≠ÁöÑÊúÄÂ§ßÊéíÂ∫èÂÄº\n      const maxOrder = db.prepare(`\n        SELECT COALESCE(MAX(sort_order), -1) as max_order \n        FROM folders \n        WHERE parent_id ${folder.parentId ? '= ?' : 'IS NULL'}\n      `).get(folder.parentId ? folder.parentId : undefined) as { max_order: number }\n      \n      const sortOrder = (maxOrder?.max_order ?? -1) + 1\n      \n      const stmt = db.prepare(`\n        INSERT INTO folders (id, name, parent_id, sort_order)\n        VALUES (?, ?, ?, ?)\n      `)\n      \n      stmt.run(id, folder.name || 'Êñ∞Êñá‰ª∂Â§π', folder.parentId || null, sortOrder)\n      \n      const created = db.prepare('SELECT * FROM folders WHERE id = ?').get(id) as FolderRow\n      return { success: true, data: rowToFolder(created) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Êõ¥Êñ∞Êñá‰ª∂Â§π\n  ipcMain.handle(IPC_CHANNELS.FOLDER_UPDATE, async (_event, id, updates) => {\n    try {\n      const fields: string[] = []\n      const values: any[] = []\n      \n      if (updates.name !== undefined) {\n        fields.push('name = ?')\n        values.push(updates.name)\n      }\n      if (updates.parentId !== undefined) {\n        fields.push('parent_id = ?')\n        values.push(updates.parentId)\n      }\n      if (updates.sortOrder !== undefined) {\n        fields.push('sort_order = ?')\n        values.push(updates.sortOrder)\n      }\n      \n      if (fields.length === 0) {\n        const existing = db.prepare('SELECT * FROM folders WHERE id = ?').get(id) as FolderRow\n        return { success: true, data: rowToFolder(existing) }\n      }\n      \n      values.push(id)\n      \n      const stmt = db.prepare(`UPDATE folders SET ${fields.join(', ')} WHERE id = ?`)\n      stmt.run(...values)\n      \n      const updated = db.prepare('SELECT * FROM folders WHERE id = ?').get(id) as FolderRow\n      return { success: true, data: rowToFolder(updated) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Âà†Èô§Êñá‰ª∂Â§π\n  ipcMain.handle(IPC_CHANNELS.FOLDER_DELETE, async (_event, id) => {\n    try {\n      db.prepare('DELETE FROM folders WHERE id = ?').run(id)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Ëé∑ÂèñÊñá‰ª∂Â§πÂàóË°®\n  ipcMain.handle(IPC_CHANNELS.FOLDER_LIST, async () => {\n    try {\n      const rows = db.prepare('SELECT * FROM folders ORDER BY sort_order').all() as FolderRow[]\n      return { success: true, data: rows.map(rowToFolder) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { v4 as uuidv4 } from 'uuid'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\ninterface TagRow {\n  id: string\n  name: string\n  color: string\n}\n\nfunction rowToTag(row: TagRow) {\n  return {\n    id: row.id,\n    name: row.name,\n    color: row.color,\n  }\n}\n\n// È¢ÑÂÆö‰πâÁöÑÊ†áÁ≠æÈ¢úËâ≤\nconst TAG_COLORS = [\n  '#409EFF', // ËìùËâ≤\n  '#67C23A', // ÁªøËâ≤\n  '#E6A23C', // Ê©ôËâ≤\n  '#F56C6C', // Á∫¢Ëâ≤\n  '#909399', // ÁÅ∞Ëâ≤\n  '#9B59B6', // Á¥´Ëâ≤\n  '#1ABC9C', // ÈùíËâ≤\n  '#E91E63', // Á≤âËâ≤\n]\n\nexport function registerTagHandlers() {\n  const db = getDatabase()\n\n  // ÂàõÂª∫Ê†áÁ≠æ\n  ipcMain.handle(IPC_CHANNELS.TAG_CREATE, async (_event, tag) => {\n    try {\n      const id = uuidv4()\n      \n      // ÈöèÊú∫ÈÄâÊã©‰∏Ä‰∏™È¢úËâ≤\n      const color = tag.color || TAG_COLORS[Math.floor(Math.random() * TAG_COLORS.length)]\n      \n      const stmt = db.prepare(`\n        INSERT INTO tags (id, name, color)\n        VALUES (?, ?, ?)\n      `)\n      \n      stmt.run(id, tag.name, color)\n      \n      const created = db.prepare('SELECT * FROM tags WHERE id = ?').get(id) as TagRow\n      return { success: true, data: rowToTag(created) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Êõ¥Êñ∞Ê†áÁ≠æ\n  ipcMain.handle(IPC_CHANNELS.TAG_UPDATE, async (_event, id, updates) => {\n    try {\n      const fields: string[] = []\n      const values: any[] = []\n      \n      if (updates.name !== undefined) {\n        fields.push('name = ?')\n        values.push(updates.name)\n      }\n      if (updates.color !== undefined) {\n        fields.push('color = ?')\n        values.push(updates.color)\n      }\n      \n      if (fields.length === 0) {\n        const existing = db.prepare('SELECT * FROM tags WHERE id = ?').get(id) as TagRow\n        return { success: true, data: rowToTag(existing) }\n      }\n      \n      values.push(id)\n      \n      const stmt = db.prepare(`UPDATE tags SET ${fields.join(', ')} WHERE id = ?`)\n      stmt.run(...values)\n      \n      const updated = db.prepare('SELECT * FROM tags WHERE id = ?').get(id) as TagRow\n      return { success: true, data: rowToTag(updated) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Âà†Èô§Ê†áÁ≠æ\n  ipcMain.handle(IPC_CHANNELS.TAG_DELETE, async (_event, id) => {\n    try {\n      db.prepare('DELETE FROM tags WHERE id = ?').run(id)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Ëé∑ÂèñÊ†áÁ≠æÂàóË°®\n  ipcMain.handle(IPC_CHANNELS.TAG_LIST, async () => {\n    try {\n      const rows = db.prepare('SELECT * FROM tags ORDER BY name').all() as TagRow[]\n      return { success: true, data: rows.map(rowToTag) }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ÁªôÁ¨îËÆ∞Ê∑ªÂä†Ê†áÁ≠æ\n  ipcMain.handle(IPC_CHANNELS.TAG_ADD_TO_NOTE, async (_event, noteId, tagId) => {\n    try {\n      const stmt = db.prepare(`\n        INSERT OR IGNORE INTO note_tags (note_id, tag_id)\n        VALUES (?, ?)\n      `)\n      stmt.run(noteId, tagId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ‰ªéÁ¨îËÆ∞ÁßªÈô§Ê†áÁ≠æ\n  ipcMain.handle(IPC_CHANNELS.TAG_REMOVE_FROM_NOTE, async (_event, noteId, tagId) => {\n    try {\n      db.prepare('DELETE FROM note_tags WHERE note_id = ? AND tag_id = ?').run(noteId, tagId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\ninterface LinkRow {\n  source_id: string\n  target_id: string\n}\n\ninterface NoteBasic {\n  id: string\n  title: string\n  type: string\n}\n\nexport function registerLinkHandlers() {\n  const db = getDatabase()\n\n  // ÂàõÂª∫ÈìæÊé•\n  ipcMain.handle(IPC_CHANNELS.LINK_CREATE, async (_event, sourceId, targetId) => {\n    try {\n      const stmt = db.prepare(`\n        INSERT OR IGNORE INTO links (source_id, target_id)\n        VALUES (?, ?)\n      `)\n      stmt.run(sourceId, targetId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Âà†Èô§ÈìæÊé•\n  ipcMain.handle(IPC_CHANNELS.LINK_DELETE, async (_event, sourceId, targetId) => {\n    try {\n      db.prepare('DELETE FROM links WHERE source_id = ? AND target_id = ?').run(sourceId, targetId)\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Ëé∑ÂèñÁ¨îËÆ∞ÁöÑÊâÄÊúâÈìæÊé•\n  ipcMain.handle(IPC_CHANNELS.LINK_GET_BY_NOTE, async (_event, noteId) => {\n    try {\n      // Ëé∑ÂèñÂá∫ÈìæÔºàÂΩìÂâçÁ¨îËÆ∞ÈìæÊé•Âà∞ÁöÑÁ¨îËÆ∞Ôºâ\n      const outLinks = db.prepare(`\n        SELECT n.id, n.title, n.type\n        FROM links l\n        JOIN notes n ON n.id = l.target_id\n        WHERE l.source_id = ?\n      `).all(noteId) as NoteBasic[]\n\n      // Ëé∑ÂèñÂÖ•ÈìæÔºàÈìæÊé•Âà∞ÂΩìÂâçÁ¨îËÆ∞ÁöÑÁ¨îËÆ∞Ôºâ\n      const inLinks = db.prepare(`\n        SELECT n.id, n.title, n.type\n        FROM links l\n        JOIN notes n ON n.id = l.source_id\n        WHERE l.target_id = ?\n      `).all(noteId) as NoteBasic[]\n\n      return {\n        success: true,\n        data: {\n          outLinks: outLinks.map(n => ({ id: n.id, title: n.title, type: n.type })),\n          inLinks: inLinks.map(n => ({ id: n.id, title: n.title, type: n.type })),\n        },\n      }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // Ëé∑ÂèñÁü•ËØÜÂõæË∞±Êï∞ÊçÆ\n  ipcMain.handle(IPC_CHANNELS.LINK_GET_GRAPH, async () => {\n    try {\n      // Ëé∑ÂèñÊâÄÊúâÁ¨îËÆ∞‰Ωú‰∏∫ËäÇÁÇπ\n      const notes = db.prepare(`\n        SELECT id, title, type FROM notes\n      `).all() as NoteBasic[]\n\n      // Ëé∑ÂèñÊâÄÊúâÈìæÊé•‰Ωú‰∏∫Ëæπ\n      const links = db.prepare(`\n        SELECT source_id, target_id FROM links\n      `).all() as LinkRow[]\n\n      const nodes = notes.map(n => ({\n        id: n.id,\n        label: n.title,\n        type: n.type as 'markdown' | 'bookmark' | 'snippet',\n      }))\n\n        const edges = links.map(l => ({\n          source: l.source_id,\n          target: l.target_id,\n        }))\n\n        return { success: true, data: edges }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { ipcMain } from 'electron'\nimport { getDatabase } from '../database'\nimport { IPC_CHANNELS } from '../constants'\n\nexport function registerSettingsHandlers() {\n  const db = getDatabase()\n\n  // Ëé∑ÂèñËÆæÁΩÆ\n  ipcMain.handle(IPC_CHANNELS.SETTINGS_GET, async () => {\n    try {\n      const rows = db.prepare('SELECT key, value FROM settings').all() as { key: string; value: string }[]\n      \n      const settings: Record<string, any> = {}\n      rows.forEach(row => {\n        try {\n          settings[row.key] = JSON.parse(row.value)\n        } catch {\n          settings[row.key] = row.value\n        }\n      })\n      \n      return { success: true, data: settings }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n\n  // ‰øùÂ≠òËÆæÁΩÆ\n  ipcMain.handle(IPC_CHANNELS.SETTINGS_SET, async (_event, settings) => {\n    try {\n      const stmt = db.prepare(`\n        INSERT OR REPLACE INTO settings (key, value)\n        VALUES (?, ?)\n      `)\n      \n      Object.entries(settings).forEach(([key, value]) => {\n        stmt.run(key, JSON.stringify(value))\n      })\n      \n      return { success: true }\n    } catch (error) {\n      return { success: false, error: String(error) }\n    }\n  })\n}\n","import { registerNoteHandlers } from './notes'\nimport { registerFolderHandlers } from './folders'\nimport { registerTagHandlers } from './tags'\nimport { registerLinkHandlers } from './links'\nimport { registerSettingsHandlers } from './settings'\n\nexport function registerAllHandlers() {\n  registerNoteHandlers()\n  registerFolderHandlers()\n  registerTagHandlers()\n  registerLinkHandlers()\n  registerSettingsHandlers()\n}\n","import { app, BrowserWindow } from 'electron'\nimport { createRequire } from 'node:module'\nimport { fileURLToPath } from 'node:url'\nimport path from 'node:path'\nimport { initDatabase, closeDatabase } from './database'\nimport { registerAllHandlers } from './ipc'\n\nconst require = createRequire(import.meta.url)\nconst __dirname = path.dirname(fileURLToPath(import.meta.url))\n\n// The built directory structure\n//\n// ‚îú‚îÄ‚î¨‚îÄ‚î¨ dist\n// ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ index.html\n// ‚îÇ ‚îÇ\n// ‚îÇ ‚îú‚îÄ‚î¨ dist-electron\n// ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ main.js\n// ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ preload.mjs\n// ‚îÇ\nprocess.env.APP_ROOT = path.join(__dirname, '..')\n\n// üöß Use ['ENV_NAME'] avoid vite:define plugin - Vite@2.x\nexport const VITE_DEV_SERVER_URL = process.env['VITE_DEV_SERVER_URL']\nexport const MAIN_DIST = path.join(process.env.APP_ROOT, 'dist-electron')\nexport const RENDERER_DIST = path.join(process.env.APP_ROOT, 'dist')\n\nprocess.env.VITE_PUBLIC = VITE_DEV_SERVER_URL ? path.join(process.env.APP_ROOT, 'public') : RENDERER_DIST\n\nlet win: BrowserWindow | null\n\nfunction createWindow() {\n  win = new BrowserWindow({\n    width: 1400,\n    height: 900,\n    minWidth: 1000,\n    minHeight: 600,\n    icon: path.join(process.env.VITE_PUBLIC, 'electron-vite.svg'),\n    titleBarStyle: 'hiddenInset',\n    trafficLightPosition: { x: 16, y: 16 },\n    webPreferences: {\n      preload: path.join(__dirname, 'preload.mjs'),\n      nodeIntegration: false,\n      contextIsolation: true,\n    },\n  })\n\n  // Test active push message to Renderer-process.\n  win.webContents.on('did-finish-load', () => {\n    win?.webContents.send('main-process-message', (new Date).toLocaleString())\n  })\n\n  if (VITE_DEV_SERVER_URL) {\n    win.loadURL(VITE_DEV_SERVER_URL)\n  } else {\n    // win.loadFile('dist/index.html')\n    win.loadFile(path.join(RENDERER_DIST, 'index.html'))\n  }\n}\n\n// Quit when all windows are closed, except on macOS. There, it's common\n// for applications and their menu bar to stay active until the user quits\n// explicitly with Cmd + Q.\napp.on('window-all-closed', () => {\n  if (process.platform !== 'darwin') {\n    app.quit()\n    win = null\n  }\n})\n\napp.on('activate', () => {\n  // On OS X it's common to re-create a window in the app when the\n  // dock icon is clicked and there are no other windows open.\n  if (BrowserWindow.getAllWindows().length === 0) {\n    createWindow()\n  }\n})\n\n// Â∫îÁî®ÈÄÄÂá∫Êó∂ÂÖ≥Èó≠Êï∞ÊçÆÂ∫ì\napp.on('before-quit', () => {\n  closeDatabase()\n})\n\napp.whenReady().then(() => {\n  // ÂàùÂßãÂåñÊï∞ÊçÆÂ∫ì\n  initDatabase()\n  // Ê≥®ÂÜåÊâÄÊúâ IPC Â§ÑÁêÜÂô®\n  registerAllHandlers()\n  // ÂàõÂª∫Á™óÂè£\n  createWindow()\n})\n"],"names":["require","db","uuidv4","createRequire","__dirname","path"],"mappings":"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","x_google_ignoreList":[1,2,3,4]}